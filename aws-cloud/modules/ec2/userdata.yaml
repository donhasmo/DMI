#cloud-config
package_update: true
package_upgrade: true

packages:
  - git
  - curl
  - nginx

runcmd:
  - |
    echo "=== STEP 2: Start and enable Nginx ==="
    systemctl start nginx
    systemctl enable nginx
    systemctl status nginx --no-pager

    # echo "=== STEP 3: Clone React app from GitHub ==="
    # cd /tmp
    # git clone https://github.com/pravinmishraaws/Azure-Static-Website.git
    # cd Azure-Static-Website

    # echo "=== STEP 6: Deploy build to Nginx web root ==="
    # rm -rf /var/www/html/*
    # cp -r /tmp/Azure-Static-Website/* /var/www/html/
    # chown -R www-data:www-data /var/www/html
    # chmod -R 755 /var/www/html

    # echo "=== STEP 7: Configure Nginx for React ==="
    # cat > /etc/nginx/sites-available/default << 'EOF'
    # server {
    #     listen 80;
    #     server_name _;

    #     root /var/www/html;
    #     index index.html;

    #     location / {
    #         try_files $uri /index.html;
    #     }

    #     error_page 404 /index.html;
    # }
    # EOF

    # systemctl restart nginx

    # echo "=== Deployment Complete! React app is live on port 80 ==="
